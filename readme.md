# 基于Frank-Wolfe算法的用户均衡模型交通分配实现

## 1.项目介绍

本项目基于Frank-wolfe算法，可以将交通分布阶段得出的交通OD分布矩阵按照已知的路网描述，分配到连接各交通节点的具体道路上。其具体实现思路如下:
- 步骤1:初始化。为加速迭代，直接使用一次全有全无分配AON作为初始的流量。
- 步骤2:更新路阻。根据阻抗函数t = t0 * (1 + (Q/C))^2,分别代入每个路段的初始流量,更新各路段阻抗。
- 步骤3:下降方向。基于阻抗，使用最短路全有全无分配法，将流量分配到对应路径上，得到临时路段流量x，进而得到更新流量的方向和大小。
- 步骤4:搜索最优步长，并更新流量。采用牛顿法，得到全局阻抗函数最小时对应的更新步长。依照步长和更新流量的方向和大小，更新各道路的流量。
- 步骤5:结束条件。如果gap小于阈值tol，则算法结束；否则重复上面步骤1至步骤5，继续更新迭代直至满足最大迭代数。
下图是在给定数据上计算出的交通分配结果。

## 2.使用方法

- 输入下面命令完成环境配置
```bash
conda create -n traffic_assignment python=3.8
conda activate traffic_assignment
pip install -r requirements.txt
```
将准备好的交通道路网络文件 netowrk.json 与交通需求文件 demand.json 放置于data目录下。
- 输入下面的命令，分别执行全有全无分配（AON），增量分配（IA）以及基于Frank-Wolfe算法的用户均衡分配
```bash
python AON.py 
python IA.py
python FW.py
```